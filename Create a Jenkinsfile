node {
    stage('SCM') {
        checkout scm
    }
    
    stage('SonarQube Analysis') {
        def mvn = tool name: 'Maven', type: 'maven';
        withSonarQubeEnv('SonarQube_Server') { 
            sh "${mvn}/bin/mvn clean verify sonar:sonar -Dsonar.projectKey=jenkins -Dsonar.projectName='jenkins'"
        }
    }
}
